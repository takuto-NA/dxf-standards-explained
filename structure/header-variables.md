# 重要ヘッダー変数

HEADERセクションには、図面全体の設定やプロパティを定義する変数が格納されます。すべての変数名は `$` で始まり、グループコード `9` で指定されます。

## 変数の読み方

ヘッダー変数は以下の形式で記述されます：

```text
  9        <-- 「次は変数名です」という合図
$変数名
 グループコード <-- その変数の「型」に応じたコード
値          <-- 具体的な設定値
```

例：
```text
  9        <-- 変数名の開始
$ACADVER
  1        <-- 文字列型の値
AC1015
```

## 必須・推奨変数

### $ACADVER (AutoCAD Version)

**グループコード**: `1` (文字列)  
**説明**: DXFファイルが作成されたAutoCADのバージョンを表します。

| 値 | バージョン |
| :--- | :--- |
| `AC1009` | AutoCAD R11/R12 |
| `AC1012` | AutoCAD R13 |
| `AC1014` | AutoCAD R14 |
| `AC1015` | AutoCAD 2000/2000i/2002 |
| `AC1018` | AutoCAD 2004/2005/2006 |
| `AC1021` | AutoCAD 2007/2008/2009 |
| `AC1024` | AutoCAD 2010/2011/2012 |
| `AC1027` | AutoCAD 2013/2014/2015/2016/2017 |
| `AC1032` | AutoCAD 2018以降 |

**実装上の注意**: バージョンによって、使用可能なグループコードやエンティティタイプが異なります。パーサーはこの値に基づいて処理を分岐させる必要があります。

### $INSUNITS (Insertion Units)

**グループコード**: `70` (整数)  
**説明**: 図面の単位系を指定します。

| 値 | 単位 |
| :--- | :--- |
| `0` | 単位なし |
| `1` | インチ |
| `2` | フィート |
| `3` | マイル |
| `4` | ミリメートル |
| `5` | センチメートル |
| `6` | メートル |
| `7` | キロメートル |
| `8` | マイクロインチ |
| `9` | ミル |
| `10` | ヤード |
| `11` | オングストローム |
| `12` | ナノメートル |
| `13` | マイクロメートル |
| `14` | デシメートル |
| `15` | デカメートル |
| `16` | ヘクトメートル |
| `17` | ギガメートル |
| `18` | 天文単位 |
| `19` | 光年 |
| `20` | パーセク |

**実装上の注意**: この値は主にメタデータとして使用されます。実際の座標値は単位情報を持たないため、アプリケーション側で適切に解釈する必要があります。

### $EXTMIN / $EXTMAX (Extents)

**グループコード**: `10, 20, 30` (浮動小数点、X, Y, Z)  
**説明**: 図面内のすべてのエンティティを含む最小/最大の境界ボックス（バウンディングボックス）を定義します。

```text
  9        <-- 変数名
$EXTMIN
 10        <-- 最小 X
-10.0
 20        <-- 最小 Y
-5.0
 30        <-- 最小 Z
0.0
  9        <-- 変数名
$EXTMAX
 10        <-- 最大 X
100.0
 20        <-- 最大 Y
50.0
 30        <-- 最大 Z
0.0
```

**実装上の注意**: これらの値は、図面の表示範囲を決定するために使用されます。エンティティを追加・削除した際は、これらの値を再計算する必要があります。

### $HANDSEED (Handle Seed)

**グループコード**: `5` (文字列、ハンドル)  
**説明**: 次に割り当てるハンドル（オブジェクトの一意識別子）のシード値です。

AutoCAD 2000以降で導入されました。各オブジェクトには一意のハンドル（16進数文字列、例: `"FF"`）が割り当てられます。

**実装上の注意**: ハンドルはオブジェクト間の参照（例: ブロック参照）で使用されます。新しいオブジェクトを作成する際は、この値をインクリメントして使用します。

## その他の重要な変数

### $LUNITS (Linear Units)

**グループコード**: `70` (整数)  
**説明**: 線形単位の表示形式を指定します。

- `1`: 科学記数法
- `2`: 小数
- `3`: 建築用（フィート-インチ）
- `4`: 分数
- `5`: 建築用（分数）

### $AUNITS (Angular Units)

**グループコード**: `70` (整数)  
**説明**: 角度単位を指定します。

- `0`: 十進度
- `1`: 度/分/秒
- `2`: グラジアン
- `3`: ラジアン
- `4`: 測量単位

### $CLAYER (Current Layer)

**グループコード**: `8` (文字列)  
**説明**: 現在の画層（レイヤー）名を指定します。

新しいエンティティが画層を明示的に指定しない場合、このレイヤーが使用されます。

### $TEXTSTYLE (Text Style)

**グループコード**: `7` (文字列)  
**説明**: 現在の文字スタイル名を指定します。

## 実装のベストプラクティス

1. **バージョンチェック**: `$ACADVER` を最初に読み込み、対応する機能を有効化します。
2. **デフォルト値の提供**: 変数が存在しない場合でも、合理的なデフォルト値（例: `$INSUNITS = 6` (メートル)）を提供します。
3. **単位の一貫性**: `$INSUNITS` と実際の座標値の単位が一致していることを確認します（DXFファイル自体は単位情報を持たないため、ドキュメントやメタデータで明示する必要があります）。
