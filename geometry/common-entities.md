# 共通エンティティ

DXFの `ENTITIES` セクションで最も頻繁に使用される、基本的な図形要素（エンティティ）の構造を解説します。

## エンティティの分類と用語

DXFで描画される個々の要素は、公式に **エンティティ (Entity)** または **グラフィカル・オブジェクト (Graphical Object)** と呼ばれます。

実装や設計の現場では、これらをさらに性質に応じて以下のように呼び分けるのが一般的ですが、これらはDXFの仕様上の厳密な区分というよりは、CAD全般の共通概念としての側面が強いです。

- **幾何エンティティ (Geometric Entity)**: LINE, CIRCLE, ARC など、純粋な幾何形状を持つもの。
- **アノテーション (Annotation / 注釈)**: TEXT, DIMENSION など、情報を付加するもの。
- **セグメント (Segment)**: ポリラインを構成する個々の「区間」。仕様書でも解説のためにこの言葉が使われます。

また、円のようにループしているものを **「閉じた (Closed)」**、直線のように端点があるものを **「開いた (Open)」** と呼びますが、これらはポリライン等のフラグ設定において公式に使われる概念です。

## 基本図形のプレビュー

<ClientOnly>
  <DxfViewer src="/samples/simple_shapes.dxf" />
</ClientOnly>

---

## 1. LINE (直線)

2つの点を結ぶ単純な線です。

```text
  0        <-- エンティティの種類
LINE
  5        <-- ハンドルID
A1
100        <-- サブクラスマーカー
AcDbEntity
  8        <-- 画層名
0
100        <-- サブクラスマーカー
AcDbLine
 10        <-- 始点 X
0.0
 20        <-- 始点 Y
0.0
 30        <-- 始点 Z
0.0
 11        <-- 終点 X
10.0
 21        <-- 終点 Y
10.0
 31        <-- 終点 Z
0.0
```

## 2. CIRCLE (円)

中心点と半径で定義される円です。

```text
  0        <-- エンティティの種類
CIRCLE
  5
A2
100
AcDbEntity
  8
0
100
AcDbCircle
 10        <-- 中心点 X
5.0
 20        <-- 中心点 Y
5.0
 30        <-- 中心点 Z
0.0
 40        <-- 半径
2.5
```

## 3. ARC (円弧)

中心点、半径、および開始/終了角度で定義される円弧です。角度は**反時計回り**の度単位で指定します。

```text
  0        <-- エンティティの種類
ARC
  8
0
 10        <-- 中心点 X
0.0
 20        <-- 中心点 Y
0.0
 40        <-- 半径
10.0
 50        <-- 開始角度 (度)
0.0
 51        <-- 終了角度 (度)
90.0
```

## 4. TEXT (一行文字)

単一行のテキストです。

```text
  0        <-- エンティティの種類
TEXT
  8
0
 10        <-- 挿入点 X
0.0
 20        <-- 挿入点 Y
0.0
 40        <-- 文字の高さ
2.5
  1        <-- テキストの内容
Hello DXF
 50        <-- 回転角度 (度)
0.0
```

## 5. LWPOLYLINE (軽量ポリライン)

複数の頂点を持つ連続した線です。R14以降で導入され、ファイルサイズが小さいため多用されます。

```text
  0        <-- エンティティの種類
LWPOLYLINE
  8
0
 90        <-- 頂点の数
2
 70        <-- フラグ (0=開いた線, 1=閉じた線)
0
 10        <-- 頂点1 X
0.0
 20        <-- 頂点1 Y
0.0
 10        <-- 頂点2 X
10.0
 20        <-- 頂点2 Y
10.0
```

::: tip LWPOLYLINEの注意点
`LWPOLYLINE` では、同じグループコード `10` や `20` が頂点の数だけ繰り返し登場します。パーサーはこれらを順番に読み取って配列に格納する必要があります。
:::
