# 線の太さ・厚み・幅

DXFにおいて「線の太さ」を表現する方法には、大きく分けて3つの異なる概念があります。これらは用語が似ていますが、意味が全く異なるため、混同しないように注意が必要です。

---

## 1. 線幅 (Lineweight)

画面表示や印刷時に適用される「見た目の太さ」です。

- **グループコード**: **370**
- **単位**: 0.01mm 単位（例: `25` は 0.25mm）。
- **特徴**:
    - ズームしても画面上の太さは変わりません（常に一定のピクセル/ミリで表示）。
    - AutoCAD 2000 (R15) から導入されました。
- **よく使われる値**:
    - `-1`: ByLayer（画層の設定に従う）
    - `-2`: ByBlock（ブロックの設定に従う）
    - `-3`: デフォルト値

---

## 2. 厚み (Thickness)

2D図形をZ軸方向に押し出した「高さ」を意味します。

- **グループコード**: **39**
- **単位**: 図面単位（WCS）。
- **特徴**:
    - 2Dの `LINE` や `CIRCLE` を「壁」のように3D化するために使われます。
    - 真上（平面図）から見ると単なる線ですが、斜め（鳥瞰図）から見ると厚みが見えます。
- **注意**: 加工機用のデータ（レーザーカット等）では、この値が指定されていても無視されるのが一般的です。

---

## 3. ポリライン幅 (Constant/Starting/Ending Width)

`LWPOLYLINE` 等で指定される、実体としての「幅」です。

- **グループコード**:
    - **43**: 一定の幅 (Constant width)
    - **40**: 開始幅 (Starting width)
    - **41**: 終了幅 (Ending width)
- **単位**: 図面単位（WCS）。
- **特徴**:
    - ズームすると線も一緒に拡大・縮小されます。
    - 開始幅と終了幅を変えることで、矢印のような「先細りの線」を表現できます。
    - 内部的には、境界線を持った「塗りつぶされた面」として扱われます。

---

## 比較まとめ

| 概念 | コード | 単位 | ズーム時の挙動 | 主な用途 |
| :--- | :--- | :--- | :--- | :--- |
| **線幅 (Lineweight)** | `370` | 0.01mm | 変化しない | 製図の規格（太線・細線）の表現 |
| **厚み (Thickness)** | `39` | 図面単位 | 変化する | 簡易的な3D表現（壁など） |
| **ポリライン幅 (Width)** | `40/41/43` | 図面単位 | 変化する | 矢印、配線パターン、実際の太さを持つ線 |

---

## 実装上のアドバイス

1. **加工機への出力**:
   レーザーカッターやCNCに送る際、多くの場合は「線の太さはゼロ（パスの芯線のみ）」として扱われます。もし太さを持たせたい場合は、`WIDTH` を持つポリラインを「中抜きの外形線」に変換（オフセット処理）する必要があります。

2. **古いDXFバージョン**:
   R14以前のDXFでは `Lineweight (370)` が存在しません。古い環境との互換性を保つには、色番号（Group 62）とペン番号を紐付けて太さを管理する「色従属印刷スタイル（CTB）」という古い手法が今でも使われています。

3. **表示の優先順位**:
   同じエンティティに `Lineweight` と `Width` の両方が設定されている場合、通常は `Width`（実体としての幅）が優先して描画されます。

---

関連：[共通エンティティ](./common-entities.md) | [ポリゴン・塗りつぶし](./polygons-and-fills.md) | [よくある罠](../implementation/common-pitfalls.md)

